<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>MT19937 算法 | KBThe0phi1us's blog</title><meta name="author" content="KBThe0phi1us"><meta name="copyright" content="KBThe0phi1us"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前言学习了MT19937算法，做了几道crypto题目，不了解MT19937算法的可以看这篇浅析MT19937伪随机数生成算法-安全客 - 安全资讯平台 (anquanke.com) [GKCTF 2021]Random题目12345678910111213import randomfrom hashlib import md5def get_mask():    file &#x3D; open(&amp;quo">
<meta property="og:type" content="article">
<meta property="og:title" content="MT19937 算法">
<meta property="og:url" content="https://kbthe0phi1us.github.io/2023/02/10/MT19937%E7%AE%97%E6%B3%95/index.html">
<meta property="og:site_name" content="KBThe0phi1us&#39;s blog">
<meta property="og:description" content="前言学习了MT19937算法，做了几道crypto题目，不了解MT19937算法的可以看这篇浅析MT19937伪随机数生成算法-安全客 - 安全资讯平台 (anquanke.com) [GKCTF 2021]Random题目12345678910111213import randomfrom hashlib import md5def get_mask():    file &#x3D; open(&amp;quo">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s1.vika.cn/space/2023/02/04/f08b3172ebdd46f9aec2dce48cabf062">
<meta property="article:published_time" content="2023-02-10T09:42:12.000Z">
<meta property="article:modified_time" content="2023-02-17T12:33:43.571Z">
<meta property="article:author" content="KBThe0phi1us">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="crypto">
<meta property="article:tag" content="题集">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s1.vika.cn/space/2023/02/04/f08b3172ebdd46f9aec2dce48cabf062"><link rel="shortcut icon" href="https://s1.vika.cn/space/2023/02/05/8bc2037846ab481088ddf95238ee1b14"><link rel="canonical" href="https://kbthe0phi1us.github.io/2023/02/10/MT19937%E7%AE%97%E6%B3%95/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":180},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: KBThe0phi1us","link":"链接: ","source":"来源: KBThe0phi1us's blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MT19937 算法',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-02-17 20:33:43'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = url => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      link.onload = () => resolve()
      link.onerror = () => reject()
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/universe.css"><svg aria-hidden="true" style="position:absolute; overflow:hidden; width:0; height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s1.vika.cn/space/2023/02/05/8bc2037846ab481088ddf95238ee1b14" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s1.vika.cn/space/2023/02/04/f08b3172ebdd46f9aec2dce48cabf062')"><nav id="nav"><span id="blog-info"><a href="/" title="KBThe0phi1us's blog"><span class="site-name">KBThe0phi1us's blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">MT19937 算法</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-02-10T09:42:12.000Z" title="发表于 2023-02-10 17:42:12">2023-02-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-02-17T12:33:43.571Z" title="更新于 2023-02-17 20:33:43">2023-02-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/">ctf</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/crypto/">crypto</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/crypto/%E7%AC%94%E8%AE%B0/">笔记</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/crypto/%E7%AC%94%E8%AE%B0/%E9%A2%98%E9%9B%86/">题集</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>17分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="MT19937 算法"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>学习了MT19937算法，做了几道crypto题目，不了解MT19937算法的可以看这篇<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/205861#h3-4">浅析MT19937伪随机数生成算法-安全客 - 安全资讯平台 (anquanke.com)</a></p>
<h1 id="GKCTF-2021-Random"><a href="#GKCTF-2021-Random" class="headerlink" title="[GKCTF 2021]Random"></a>[GKCTF 2021]Random</h1><h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_mask</span>():</span><br><span class="line">    file = <span class="built_in">open</span>(<span class="string">&quot;random.txt&quot;</span>,<span class="string">&quot;w&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">104</span>):</span><br><span class="line">        file.write(<span class="built_in">str</span>(random.getrandbits(<span class="number">32</span>))+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        file.write(<span class="built_in">str</span>(random.getrandbits(<span class="number">64</span>))+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        file.write(<span class="built_in">str</span>(random.getrandbits(<span class="number">96</span>))+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    file.close()</span><br><span class="line">get_mask()</span><br><span class="line">flag = md5(<span class="built_in">str</span>(random.getrandbits(<span class="number">32</span>)).encode()).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br></pre></td><td class="code"><pre><span class="line">2584323193</span><br><span class="line">1099154419438958164</span><br><span class="line">35367876945070316311325317953</span><br><span class="line">481304047</span><br><span class="line">12782770146993102006</span><br><span class="line">24789628292419559503661788402</span><br><span class="line">2776391832</span><br><span class="line">9046887565683900291</span><br><span class="line">50006261016517120573540241998</span><br><span class="line">4167723109</span><br><span class="line">8540277546428614473</span><br><span class="line">5932047064656933473553742683</span><br><span class="line">2951765291</span><br><span class="line">10958280862127627756</span><br><span class="line">61364239380151547478360346674</span><br><span class="line">727043053</span><br><span class="line">10156271057154381198</span><br><span class="line">32168336768992329620376069852</span><br><span class="line">930821842</span><br><span class="line">16276235036285538859</span><br><span class="line">9299952556848430743503551046</span><br><span class="line">2868231632</span><br><span class="line">5239154873841417200</span><br><span class="line">11073503953912227254738321705</span><br><span class="line">3452646652</span><br><span class="line">8203253126417399900</span><br><span class="line">52795367131471301612397944513</span><br><span class="line">1927997107</span><br><span class="line">17486869700317373240</span><br><span class="line">47859970254711877167132319582</span><br><span class="line">1459348891</span><br><span class="line">9270456490024856463</span><br><span class="line">74988967035830352654888842228</span><br><span class="line">3714813644</span><br><span class="line">1001128959491001919</span><br><span class="line">8338265486641240510773094199</span><br><span class="line">1430706700</span><br><span class="line">17510828220752339511</span><br><span class="line">3163106687132931419335230580</span><br><span class="line">663535320</span><br><span class="line">9606088298064978425</span><br><span class="line">42511409828594385595915384953</span><br><span class="line">908684643</span><br><span class="line">5421916296165007941</span><br><span class="line">9630914642938890694059952508</span><br><span class="line">2209941143</span><br><span class="line">14999144064788271892</span><br><span class="line">3764842169035734035997078921</span><br><span class="line">2718456651</span><br><span class="line">8541807093002241064</span><br><span class="line">70305992075768658972224974121</span><br><span class="line">930303353</span><br><span class="line">887596273180600202</span><br><span class="line">62528479418364179541352908078</span><br><span class="line">3365397759</span><br><span class="line">15219084820731944344</span><br><span class="line">31433566654697222176709895388</span><br><span class="line">1608992428</span><br><span class="line">6417140575231408939</span><br><span class="line">12879789575923814684090165215</span><br><span class="line">2811970399</span><br><span class="line">6123213785028348335</span><br><span class="line">44681647388937033220521089118</span><br><span class="line">1260870056</span><br><span class="line">5601104844042776691</span><br><span class="line">73199461252301674455633950458</span><br><span class="line">883231057</span><br><span class="line">17783480959798771462</span><br><span class="line">53460694547508318015132953966</span><br><span class="line">1332985617</span><br><span class="line">6673661714524041073</span><br><span class="line">54253348096650113440476985084</span><br><span class="line">3911521675</span><br><span class="line">3438383273755779719</span><br><span class="line">50129032267969019444282164464</span><br><span class="line">3311412816</span><br><span class="line">8779405363908462634</span><br><span class="line">77818642029003078860467063235</span><br><span class="line">4204237422</span><br><span class="line">17534771551489868719</span><br><span class="line">47280916590275648057356977963</span><br><span class="line">2090173606</span><br><span class="line">12206397967662831376</span><br><span class="line">9495602410639024810670107439</span><br><span class="line">2896231201</span><br><span class="line">7246124017447704664</span><br><span class="line">64467120363081017096405905335</span><br><span class="line">392254334</span><br><span class="line">12789011750322942845</span><br><span class="line">5247110397471141497763090834</span><br><span class="line">814200188</span><br><span class="line">14344105251896958923</span><br><span class="line">38888779745538270252730950782</span><br><span class="line">205529919</span><br><span class="line">13939756220516981581</span><br><span class="line">67139045733351688501202495914</span><br><span class="line">3563698832</span><br><span class="line">16840754399626540384</span><br><span class="line">15354843719521267197455444900</span><br><span class="line">1386481456</span><br><span class="line">17766886653399976694</span><br><span class="line">61203331542727632580855864074</span><br><span class="line">2032518919</span><br><span class="line">2355401958853696908</span><br><span class="line">58793908005730868677649498244</span><br><span class="line">3991002745</span><br><span class="line">6506506581713943242</span><br><span class="line">49187675946469291318483292566</span><br><span class="line">2346942877</span><br><span class="line">994297989736899070</span><br><span class="line">45437626728896532873251413177</span><br><span class="line">3841694984</span><br><span class="line">14253899037419430689</span><br><span class="line">8435766077661599453131339442</span><br><span class="line">1679990328</span><br><span class="line">5515793210854183190</span><br><span class="line">32981467195097563488749918497</span><br><span class="line">744869832</span><br><span class="line">11965860903258650511</span><br><span class="line">73456728458781563185478913274</span><br><span class="line">1341354796</span><br><span class="line">14941036303190219170</span><br><span class="line">3601563989190071059996878006</span><br><span class="line">3361509481</span><br><span class="line">17629804697469609923</span><br><span class="line">39935200308805986497519634478</span><br><span class="line">213152541</span><br><span class="line">18320881664493742431</span><br><span class="line">35325602739583757661562537619</span><br><span class="line">2583841550</span><br><span class="line">13763800051589427155</span><br><span class="line">24638499459902141689405229579</span><br><span class="line">1930742512</span><br><span class="line">2392210857598517491</span><br><span class="line">10441235412645941387574306751</span><br><span class="line">461860348</span><br><span class="line">2960745717639761142</span><br><span class="line">62671223148116753112168252981</span><br><span class="line">342206006</span><br><span class="line">6480900103080233462</span><br><span class="line">68412521040142848818877222548</span><br><span class="line">114798494</span><br><span class="line">8473329380799862296</span><br><span class="line">13698669860489083061204052132</span><br><span class="line">2900249131</span><br><span class="line">4183161143099214314</span><br><span class="line">18705391538460150746163889528</span><br><span class="line">3766817970</span><br><span class="line">12378384893542868384</span><br><span class="line">55065668763750424532726429526</span><br><span class="line">937387269</span><br><span class="line">6844068130337459179</span><br><span class="line">3209183745118985928581969258</span><br><span class="line">3341723085</span><br><span class="line">5988612409695647387</span><br><span class="line">74389503837936256104231536479</span><br><span class="line">4240599755</span><br><span class="line">15332231015110371140</span><br><span class="line">62955965591068690743297262172</span><br><span class="line">1555895753</span><br><span class="line">6058791220464667520</span><br><span class="line">38335642957673073804843192014</span><br><span class="line">810331063</span><br><span class="line">4826913432979346480</span><br><span class="line">28611765156689124521247554769</span><br><span class="line">2630955218</span><br><span class="line">12776823600930336401</span><br><span class="line">4939603509311727391894886152</span><br><span class="line">3280912700</span><br><span class="line">14886149455945180990</span><br><span class="line">52545650130177883790984384989</span><br><span class="line">2356751225</span><br><span class="line">2213402912509116749</span><br><span class="line">7670693824287789893690942739</span><br><span class="line">1599077432</span><br><span class="line">14059140725965938936</span><br><span class="line">16912587144697957583184157226</span><br><span class="line">1304928684</span><br><span class="line">9448367331308980026</span><br><span class="line">22467661289496622162065003733</span><br><span class="line">2001054151</span><br><span class="line">7669140498758745837</span><br><span class="line">39387592809285963406216440474</span><br><span class="line">1711960460</span><br><span class="line">3944628516045148813</span><br><span class="line">66275496498554499967007163069</span><br><span class="line">1207238325</span><br><span class="line">3474935157030029491</span><br><span class="line">63309877710388250418928028870</span><br><span class="line">759170859</span><br><span class="line">5858654703302236387</span><br><span class="line">47609248816278271537847269046</span><br><span class="line">1571940308</span><br><span class="line">8335124609741508060</span><br><span class="line">63542562244865676783377908343</span><br><span class="line">1103531693</span><br><span class="line">673654248555391502</span><br><span class="line">30211221866217572233934551180</span><br><span class="line">1089271924</span><br><span class="line">7205932443049001486</span><br><span class="line">69303844715341292680611559319</span><br><span class="line">78608136</span><br><span class="line">3404862937733764913</span><br><span class="line">4259499119552843766282799518</span><br><span class="line">2856032696</span><br><span class="line">18313272414884625578</span><br><span class="line">13693483738598197670400133831</span><br><span class="line">873953734</span><br><span class="line">7709221139118742639</span><br><span class="line">34347437826101106015248365081</span><br><span class="line">1783225370</span><br><span class="line">16395574393179667285</span><br><span class="line">7105819215807952823387139051</span><br><span class="line">4039492686</span><br><span class="line">16956581102357069698</span><br><span class="line">57880199206788615132959351746</span><br><span class="line">4151578751</span><br><span class="line">2089635663127651746</span><br><span class="line">37224845035383461896791495968</span><br><span class="line">3139901611</span><br><span class="line">7354140220471025697</span><br><span class="line">7677374435615054008235674795</span><br><span class="line">2008633712</span><br><span class="line">13970520912420834879</span><br><span class="line">64431013803082441566118213963</span><br><span class="line">1788996018</span><br><span class="line">16490194110734000780</span><br><span class="line">30074301251997624246501473245</span><br><span class="line">2460472485</span><br><span class="line">2420976394683211164</span><br><span class="line">63223457068346692358441841920</span><br><span class="line">83976303</span><br><span class="line">11597367904222552300</span><br><span class="line">541189103864720560882255271</span><br><span class="line">1271705896</span><br><span class="line">8355873362347678325</span><br><span class="line">6344182152495584455275136810</span><br><span class="line">516191728</span><br><span class="line">14301559481738139949</span><br><span class="line">56972815139785900061169383374</span><br><span class="line">3206833632</span><br><span class="line">10471460817277304217</span><br><span class="line">48253348743985600958199235128</span><br><span class="line">4093394606</span><br><span class="line">18421023127368906484</span><br><span class="line">3209763791222301851974194188</span><br><span class="line">2294793393</span><br><span class="line">5804188421524711527</span><br><span class="line">71797815201668391465761200460</span><br><span class="line">3776041666</span><br><span class="line">4108093307245233290</span><br><span class="line">36986873094794981638319354001</span><br><span class="line">1123598142</span><br><span class="line">18262625851690101956</span><br><span class="line">75211342463083839154547686361</span><br><span class="line">1000669502</span><br><span class="line">18244976169672436911</span><br><span class="line">72759872679663719847870853888</span><br><span class="line">2863001571</span><br><span class="line">18304840778989692776</span><br><span class="line">22413497817784765711206417816</span><br><span class="line">1497794697</span><br><span class="line">11739492739170519132</span><br><span class="line">67625171938756611423023578679</span><br><span class="line">3351136254</span><br><span class="line">11816001323328933293</span><br><span class="line">68942708548438536419919996191</span><br><span class="line">1327110822</span><br><span class="line">1299589815565305619</span><br><span class="line">62081225258542372826911047279</span><br><span class="line">3410663545</span><br><span class="line">13158537297009141542</span><br><span class="line">21762078985419016317415112411</span><br><span class="line">1245509971</span><br><span class="line">8804545967037621189</span><br><span class="line">12841311881373962346628325162</span><br><span class="line">2090373367</span><br><span class="line">5289193049949531539</span><br><span class="line">58444176241871300895472370959</span><br><span class="line">571136405</span><br><span class="line">2357132884718584788</span><br><span class="line">51271731657715979715595461713</span><br><span class="line">1432929573</span><br><span class="line">503683219995130744</span><br><span class="line">42705435265543268884777575518</span><br><span class="line">1452726104</span><br><span class="line">2295689344585140511</span><br><span class="line">56996373195070838495288737642</span><br><span class="line">187502663</span><br><span class="line">13760641334049999515</span><br><span class="line">64971355271690455751992498230</span><br><span class="line">2679386081</span><br><span class="line">172294286357194222</span><br><span class="line">78658263482976308261205349174</span><br><span class="line">2643925505</span><br><span class="line">9627451492376735719</span><br><span class="line">44487428240561493246393172961</span><br><span class="line">983662371</span><br><span class="line">2375149476902080328</span><br><span class="line">39784456552690724305541938380</span><br><span class="line">3306946267</span><br><span class="line">16316178008270132149</span><br><span class="line">76712503805317876365091515524</span><br><span class="line">3779008319</span><br><span class="line">4892998918237451139</span><br><span class="line">46329724632809073972496761660</span><br><span class="line">3841865427</span><br><span class="line">15115042473603448600</span><br><span class="line">34888855489304037538590108588</span><br><span class="line">585968278</span><br><span class="line">15088560943809914475</span><br><span class="line">46621092548977030580425482842</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="解决方法一"><a href="#解决方法一" class="headerlink" title="解决方法一"></a>解决方法一</h2><blockquote>
<p>随机数生成函数是random.getrandbits(k)</p>
<p>在<a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/library/random.html#random.getrandbits">python官方文档</a>里有描述:random.getrandbits(k)：<br>返回具有 k 个随机比特位的非负 Python 整数。 此方法随 MersenneTwister 生成器一起提供，其他一些生成器也可能将其作为 API 的可选部分提供。 在可能的情况下，getrandbits() 会启用 randrange() 来处理任意大的区间。<br>在 3.9 版更改: 此方法现在接受零作为 k 的值。</p>
<p>由此可判断考察的是梅森旋转算法</p>
</blockquote>
<blockquote>
<p>通过题目代码，我们知道总共获取了104*3个随机数，104个32位的，104个64位的，104个96位的。他们都是由32位整数序列产生的，但是104个32位的需要产生104个随机数，104个64位的需要产生208个随机数，104个96位的需要产生312个随机数，加起来总共需要产生624个随机数。</p>
<p>这个数字刚刚好对应了624个state块的个数，所以按道理，我们可以将624个state块的状态推出来，然后就可以推出下面产生的随机数，也就是flag了。</p>
</blockquote>
<p>所以我们首先需要将txt文档里的一些随机数进行分解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">prng = []</span><br><span class="line">j=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">    i = i.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">int</span>(i).bit_length())</span><br><span class="line">    <span class="keyword">if</span>(j%<span class="number">3</span>==<span class="number">0</span>):</span><br><span class="line">        prng.append(<span class="built_in">int</span>(i))</span><br><span class="line">    <span class="keyword">elif</span>(j%<span class="number">3</span>==<span class="number">1</span>):<span class="comment">#将生成两次随机数的两个随机数分离出来</span></span><br><span class="line">        prng.append(<span class="built_in">int</span>(i)&amp; (<span class="number">2</span> ** <span class="number">32</span> - <span class="number">1</span>))</span><br><span class="line">        prng.append(<span class="built_in">int</span>(i)&gt;&gt; <span class="number">32</span>)</span><br><span class="line">    <span class="keyword">else</span>:<span class="comment">#将生成三次随机数的三个随机数分离出来</span></span><br><span class="line">        prng.append(<span class="built_in">int</span>(i)&amp; (<span class="number">2</span> ** <span class="number">32</span> - <span class="number">1</span>))</span><br><span class="line">        prng.append(<span class="built_in">int</span>(i)&amp; (<span class="number">2</span> ** <span class="number">64</span> - <span class="number">1</span>) &gt;&gt; <span class="number">32</span>)</span><br><span class="line">        prng.append(<span class="built_in">int</span>(i)&gt;&gt;<span class="number">64</span>)</span><br><span class="line">    j+=<span class="number">1</span></span><br></pre></td></tr></table></figure>



<p>完整代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> Random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_right</span>(<span class="params">m,l,val=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">    length = <span class="number">32</span></span><br><span class="line">    mx = <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">if</span> val == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        val = mx</span><br><span class="line">    i,res = <span class="number">0</span>,<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i*l&lt;length:</span><br><span class="line">        mask = (mx&lt;&lt;(length-l)&amp;mx)&gt;&gt;i*l</span><br><span class="line">        tmp = m &amp; mask</span><br><span class="line">        m = m^tmp&gt;&gt;l&amp;val</span><br><span class="line">        res += tmp</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_left</span>(<span class="params">m,l,val</span>):</span><br><span class="line">    length = <span class="number">32</span></span><br><span class="line">    mx = <span class="number">0xffffffff</span></span><br><span class="line">    i,res = <span class="number">0</span>,<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i*l &lt; length:</span><br><span class="line">        mask = (mx&gt;&gt;(length-l)&amp;mx)&lt;&lt;i*l</span><br><span class="line">        tmp = m &amp; mask</span><br><span class="line">        m ^= tmp&lt;&lt;l&amp;val</span><br><span class="line">        res |= tmp</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_temper</span>(<span class="params">m</span>):</span><br><span class="line">    m = invert_right(m,<span class="number">18</span>)</span><br><span class="line">    m = invert_left(m,<span class="number">15</span>,<span class="number">4022730752</span>)</span><br><span class="line">    m = invert_left(m,<span class="number">7</span>,<span class="number">2636928640</span>)</span><br><span class="line">    m = invert_right(m,<span class="number">11</span>)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">clone_mt</span>(<span class="params">record</span>):</span><br><span class="line">    state = [invert_temper(i) <span class="keyword">for</span> i <span class="keyword">in</span> record]</span><br><span class="line">    gen = Random()</span><br><span class="line">    gen.setstate((<span class="number">3</span>,<span class="built_in">tuple</span>(state+[<span class="number">0</span>]),<span class="literal">None</span>))</span><br><span class="line">    <span class="keyword">return</span> gen</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;random.txt&quot;</span>,<span class="string">&#x27;r&#x27;</span>).readlines()</span><br><span class="line">prng = []</span><br><span class="line">j=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">    i = i.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="comment">#print(int(i).bit_length())</span></span><br><span class="line">    <span class="keyword">if</span>(j%<span class="number">3</span>==<span class="number">0</span>):</span><br><span class="line">        prng.append(<span class="built_in">int</span>(i))</span><br><span class="line">    <span class="keyword">elif</span>(j%<span class="number">3</span>==<span class="number">1</span>):<span class="comment">#将生成两次随机数的两个随机数分离出来</span></span><br><span class="line">        prng.append(<span class="built_in">int</span>(i)&amp; (<span class="number">2</span> ** <span class="number">32</span> - <span class="number">1</span>))</span><br><span class="line">        prng.append(<span class="built_in">int</span>(i)&gt;&gt; <span class="number">32</span>)</span><br><span class="line">    <span class="keyword">else</span>:<span class="comment">#将生成三次随机数的三个随机数分离出来</span></span><br><span class="line">        prng.append(<span class="built_in">int</span>(i)&amp; (<span class="number">2</span> ** <span class="number">32</span> - <span class="number">1</span>))</span><br><span class="line">        prng.append(<span class="built_in">int</span>(i)&amp; (<span class="number">2</span> ** <span class="number">64</span> - <span class="number">1</span>) &gt;&gt; <span class="number">32</span>)</span><br><span class="line">        prng.append(<span class="built_in">int</span>(i)&gt;&gt;<span class="number">64</span>)</span><br><span class="line">    j+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">g = clone_mt(prng[:<span class="number">624</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">    g.getrandbits(<span class="number">32</span>)<span class="comment">#产生前624个随机数，让state状态到生成flag前</span></span><br><span class="line"></span><br><span class="line">key = g.getrandbits(<span class="number">32</span>)</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">flag = md5(<span class="built_in">str</span>(key).encode()).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag&#123;&quot;</span>+<span class="built_in">str</span>(flag)+<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="comment">#14c71fec812b754b2061a35a4f6d8421</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="解决方法二"><a href="#解决方法二" class="headerlink" title="解决方法二"></a>解决方法二</h2><blockquote>
<p>注意：别忘了对64，96位的随机数进行分解</p>
<p>使用python中的randcrack库也可破解random.getrandbits(k)随机生成的数</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> randcrack <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;random.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f=f.readlines()</span><br><span class="line">prng=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(f),<span class="number">3</span>):    </span><br><span class="line">    prng.append(<span class="built_in">int</span>(f[i]))</span><br><span class="line">    <span class="comment">#将生成两次随机数的两个随机数分离出来</span></span><br><span class="line">    prng.append(<span class="built_in">int</span>(f[i+<span class="number">1</span>])&amp; (<span class="number">2</span> ** <span class="number">32</span> - <span class="number">1</span>))</span><br><span class="line">    prng.append(<span class="built_in">int</span>(f[i+<span class="number">1</span>])&gt;&gt; <span class="number">32</span>)</span><br><span class="line">    <span class="comment">#将生成三次随机数的三个随机数分离出来</span></span><br><span class="line">    prng.append(<span class="built_in">int</span>(f[i+<span class="number">2</span>])&amp; (<span class="number">2</span> ** <span class="number">32</span> - <span class="number">1</span>))</span><br><span class="line">    prng.append(<span class="built_in">int</span>(f[i+<span class="number">2</span>])&amp; (<span class="number">2</span> ** <span class="number">64</span> - <span class="number">1</span>) &gt;&gt; <span class="number">32</span>)</span><br><span class="line">    prng.append(<span class="built_in">int</span>(f[i+<span class="number">2</span>])&gt;&gt;<span class="number">64</span>)</span><br><span class="line">rc= RandCrack()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> prng:</span><br><span class="line">    rc.submit(i)</span><br><span class="line">flag=rc.predict_getrandbits(<span class="number">32</span>)</span><br><span class="line"><span class="built_in">print</span>(md5(<span class="built_in">str</span>(flag).encode()).hexdigest())</span><br></pre></td></tr></table></figure>





<h1 id="HNCTF-2022-WEEK4-random"><a href="#HNCTF-2022-WEEK4-random" class="headerlink" title="[HNCTF 2022 WEEK4]random"></a>[HNCTF 2022 WEEK4]random</h1><h2 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">666</span>):</span><br><span class="line">    f.write(<span class="string">f&#x27;<span class="subst">&#123;getrandbits(<span class="number">32</span>)&#125;</span>\n&#x27;</span>)</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">r = getrandbits(<span class="number">32</span>)</span><br><span class="line">key = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(r)[<span class="number">2</span>:])</span><br><span class="line">key = md5(key).digest()</span><br><span class="line">cipher = AES.new(key,AES.MODE_CBC)</span><br><span class="line">c = cipher.encrypt(pad(flag,<span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = \&#x27;<span class="subst">&#123;cipher.iv.<span class="built_in">hex</span>() + c.<span class="built_in">hex</span>()&#125;</span>\&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = &#x27;91fd1824ddc0a35e845e87f59e53a103334df418e6a65a7d7769699c3ca2119019361cd23a46a61d4e7f6cdff5f5200f586f90b66eabfd8ecff4ddf11ee444d37f80ada0bbe8af09e4fc32c1a51e3f29e2771b51c71d2ba4acb84fda61904b96&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><blockquote>
<p>题目用getrandbits()生成了666个32位的随机数，借助randcrack模块来预测第43个随机数，此时该随机数的md5摘要即为key，之后进行AES解密，。然后把16进制的c转成byte类型，取前面16位作为iv,16位以后的值则为密文c。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> randcrack <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#c=0x91fd1824ddc0a35e845e87f59e53a103334df418e6a65a7d7769699c3ca2119019361cd23a46a61d4e7f6cdff5f5200f586f90b66eabfd8ecff4ddf11ee444d37f80ada0bbe8af09e4fc32c1a51e3f29e2771b51c71d2ba4acb84fda61904b96</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f=f.readlines()</span><br><span class="line">prng=[]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(f))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(f)):</span><br><span class="line">    prng.append(<span class="built_in">int</span>(f[i]))</span><br><span class="line">rc= RandCrack()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> prng[:<span class="number">624</span>]:</span><br><span class="line">    rc.submit(i)    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">    r=rc.predict_getrandbits(<span class="number">32</span>)</span><br><span class="line">r=rc.predict_getrandbits(<span class="number">32</span>)</span><br><span class="line"><span class="built_in">print</span>(md5(<span class="built_in">str</span>(r).encode()).hexdigest())</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = binascii.unhexlify(&#x27;91fd1824ddc0a35e845e87f59e53a103334df418e6a65a7d7769699c3ca2119019361cd23a46a61d4e7f6cdff5f5200f586f90b66eabfd8ecff4ddf11ee444d37f80ada0bbe8af09e4fc32c1a51e3f29e2771b51c71d2ba4acb84fda61904b96&#x27;)</span></span><br><span class="line">c=<span class="number">0x91fd1824ddc0a35e845e87f59e53a103334df418e6a65a7d7769699c3ca2119019361cd23a46a61d4e7f6cdff5f5200f586f90b66eabfd8ecff4ddf11ee444d37f80ada0bbe8af09e4fc32c1a51e3f29e2771b51c71d2ba4acb84fda61904b96</span></span><br><span class="line">c=long_to_bytes(c)</span><br><span class="line">iv = c[:<span class="number">16</span>]</span><br><span class="line">c = c[<span class="number">16</span>:]</span><br><span class="line">key = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(r)[<span class="number">2</span>:])</span><br><span class="line">key = md5(key).digest()</span><br><span class="line">aes = AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">m = aes.decrypt(c)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment">#b&#x27;NSSCTF&#123;Every_Mersenne_prime_corresponds_2_exactly_1_perfect_number&#125;\r\r\r\r\r\r\r\r\r\r\r\r\r&#x27;</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>在这里介绍另一个解决mt19937算法的模板库：mt19937predictor</p>
<p><a target="_blank" rel="noopener" href="https://github.com/kmyk/mersenne-twister-predictor">下载地址</a></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> mt19937predictor <span class="keyword">import</span> MT19937Predictor</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">random_list = []</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">    random_list.append(<span class="built_in">int</span>(i))</span><br><span class="line">f.close()</span><br><span class="line">pre = MT19937Predictor()</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">    pre.setrandbits(random_list[j],<span class="number">32</span>)</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">    pre.getrandbits(<span class="number">32</span>)</span><br><span class="line">r = pre.getrandbits(<span class="number">32</span>)</span><br><span class="line">c = binascii.unhexlify(<span class="string">&#x27;91fd1824ddc0a35e845e87f59e53a103334df418e6a65a7d7769699c3ca2119019361cd23a46a61d4e7f6cdff5f5200f586f90b66eabfd8ecff4ddf11ee444d37f80ada0bbe8af09e4fc32c1a51e3f29e2771b51c71d2ba4acb84fda61904b96&#x27;</span>)</span><br><span class="line">iv = c[:<span class="number">16</span>]</span><br><span class="line">c = c[<span class="number">16</span>:]</span><br><span class="line">key = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(r)[<span class="number">2</span>:])</span><br><span class="line">key = md5(key).digest()</span><br><span class="line">aes = AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">m = aes.decrypt(c)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure>





<h1 id="HGAME-2022-week4-PRNG"><a href="#HGAME-2022-week4-PRNG" class="headerlink" title="[HGAME 2022 week4]PRNG"></a>[HGAME 2022 week4]PRNG</h1><h2 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PRNG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed = <span class="number">0</span></span>):</span><br><span class="line">        self.__register = [<span class="number">0</span>] * <span class="number">624</span></span><br><span class="line">        self.__state = <span class="number">0</span></span><br><span class="line">        self.__register[<span class="number">0</span>] = seed</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">624</span>):</span><br><span class="line">            prev = self.__register[i - <span class="number">1</span>]</span><br><span class="line">            temp = <span class="number">0x6c078965</span> * (prev ^ (prev &gt;&gt; <span class="number">30</span>)) + i</span><br><span class="line">            self.__register[i] = temp &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.__state == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">                y = (self.__register[i] &amp; <span class="number">0x80000000</span>) + (self.__register[(i + <span class="number">1</span>) % <span class="number">624</span>] &amp; <span class="number">0x7fffffff</span>)</span><br><span class="line">                self.__register[i] = self.__register[(i + <span class="number">397</span>) % <span class="number">624</span>] ^ (y &gt;&gt; <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">if</span> y % <span class="number">2</span>:</span><br><span class="line">                    self.__register[i] ^= <span class="number">0x9908b0df</span></span><br><span class="line">        y = self.__register[self.__state]</span><br><span class="line">        y = y ^ (y &gt;&gt; <span class="number">11</span>)</span><br><span class="line">        y = y ^ (y &lt;&lt; <span class="number">7</span>) &amp; <span class="number">0x9d2c5680</span></span><br><span class="line">        y = y ^ (y &lt;&lt; <span class="number">15</span>) &amp; <span class="number">0xefc60000</span></span><br><span class="line">        y = y ^ (y &gt;&gt; <span class="number">18</span>)</span><br><span class="line">        self.__state = (self.__state + <span class="number">1</span>) % <span class="number">624</span></span><br><span class="line">        <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">load_register</span>(<span class="params">self,register</span>):</span><br><span class="line">        self.__register = register</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> s2n</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> PRNG <span class="keyword">import</span> PRNG</span><br><span class="line"></span><br><span class="line">mt = PRNG(randrange(<span class="number">0</span>, <span class="number">1</span> &lt;&lt; <span class="number">32</span>))</span><br><span class="line"><span class="built_in">print</span>([mt() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>)])</span><br><span class="line"><span class="built_in">print</span>([part ^ mt() <span class="keyword">for</span> part <span class="keyword">in</span> <span class="built_in">map</span>(s2n, re.findall(<span class="string">&quot;.&#123;1,4&#125;&quot;</span>, flag))])</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[888058162, 3094055443, 1404990361, 1012543603, 448723884, 2580444236, 201608779, 1062995809, 1348787313, 2980019361, 2245025385, 494977308, 4042503808, 275744301, 406611131, 142226472, 3871761759, 3888795536, 2617489687, 1220227074, 342928858, 3728958896, 1477077966, 1433151407, 1119405037, 330145973, 3547181160, 2123007249, 3739964132, 1794129718, 2739743522, 2291585121, 3013727731, 1536788463, 247633572, 408079265, 3025555185, 1604681922, 2848997116, 3646041955, 1059445774, 2849764176, 2638965889, 1232303180, 759521642, 2257008531, 3932082254, 1052428413, 4017559916, 3505694223, 1418363972, 477751107, 4266295945, 3832138928, 245251422, 1964323108, 2453472918, 3029032760, 323619451, 2548825339, 3410027991, 278143595, 816124107, 245705463, 4173686519, 4100831820, 3599257115, 2274885516, 3954736394, 198254482, 1050449178, 3933150558, 899220021, 597474632, 1823539097, 3340511318, 2144918682, 2310527451, 264391694, 69923676, 3266017310, 3199627722, 4035962745, 932969905, 2832951013, 2182887504, 1374919242, 2978944795, 1840647233, 3510878043, 3250544991, 4255542321, 804377010, 1286980519, 1980427321, 2893246724, 1745353148, 1406140332, 4101848568, 3227434698, 1869729934, 2638181242, 1270111849, 2387910792, 3411542702, 2793303435, 2455337459, 2802808043, 2418872990, 1043274549, 144911746, 2312236858, 780373658, 1527499811, 3402753408, 2617924770, 1659648360, 2714315441, 4202103851, 244677433, 1963258902, 3851363324, 3454195559, 813228826, 3944899734, 3697685234, 1613584167, 1874570879, 1592343033, 4194241173, 551902434, 3460909265, 4122075287, 176665387, 152849760, 3593212904, 952880017, 1793357635, 2052902220, 807859486, 334839380, 3485132343, 2113403566, 3259106798, 1443078482, 2434820318, 1347902400, 2344061487, 141766876, 2641586235, 287277458, 2385094526, 1510128758, 348957861, 2861038633, 1135611795, 4289024199, 1021202791, 2460872523, 3837050794, 4092005952, 52622948, 387056916, 3102913460, 4098715316, 154916530, 2890197932, 1441566957, 2368779800, 271808452, 3566810840, 2227022452, 316480679, 603893066, 2121889912, 4208763743, 3098334580, 721958838, 3848020801, 1029884135, 832405094, 2276817394, 981553190, 246940442, 1069231974, 3275216531, 58945988, 4100121200, 230446475, 2396021649, 4608139, 3468707911, 3249498323, 315898153, 3280797960, 388108494, 1110548082, 2357147660, 2336724751, 4047583630, 2108667879, 2784078579, 1170844412, 3920262445, 3564073655, 590490534, 1645945278, 2487463163, 434409966, 1563546251, 888601967, 1913513318, 1327448740, 2504517969, 304688984, 1443685450, 4040619940, 3601250858, 4097529433, 4260590151, 575843085, 1114360271, 2186035374, 2821388594, 3763206347, 4283149630, 4097168778, 1924538037, 3272064650, 1689166701, 1352331676, 520525342, 2954296222, 2629516330, 3674317458, 231784130, 1930132422, 4169222397, 1638784833, 1245667959, 1253759350, 1154928813, 66021172, 3217915692, 4159785573, 3798512628, 2945489695, 700725579, 3940231312, 1960713279, 3289722468, 2970919839, 1356139680, 1141841193, 629177162, 3696263539, 1084872874, 4294077062, 1115547807, 3421092527, 611575307, 7808529, 2784523837, 1267307982, 1538837032, 4038330055, 3262951566, 3139820067, 1249725729, 757191354, 3025188720, 291705345, 575676661, 3023956263, 1045504889, 205204207, 1777650027, 1956698897, 996147619, 1470431, 2275722398, 2666078800, 470333070, 1306693906, 2968672077, 2476023772, 2645573325, 3939390068, 2874886754, 4226430090, 2290851636, 3707585663, 109770347, 127373916, 815817847, 1565834917, 636869794, 4062053412, 583594822, 3782553071, 3293311273, 2801932604, 2647080862, 1514083254, 3534640458, 342361004, 3266111849, 2157351044, 1851728420, 3412596866, 2793236910, 3758306563, 1799548561, 952631672, 912455646, 2894404493, 2194084105, 119615608, 2071058651, 1524462411, 900936180, 3697554830, 3501838982, 2874465656, 2501478689, 1069024222, 3135689372, 1168458702, 1966524629, 36400028, 2704775319, 4030739700, 3985599923, 2778920518, 2669538325, 1951594393, 795749079, 665593501, 3007338649, 1535343068, 2031873237, 3202423789, 560224943, 1290838890, 2545130826, 695695377, 3048615291, 1957903923, 1986693779, 2594986519, 3396211122, 2625687092, 575329062, 2852671310, 3472799759, 715985207, 1660331651, 958648594, 305711662, 75621441, 548447557, 2473842353, 2110558182, 3321750402, 2415793078, 815198061, 1258834500, 972966677, 3267046345, 2923564883, 518207679, 1662309775, 278933232, 4294256390, 2444117793, 2241879973, 3915962245, 3836532482, 3449260219, 1092128833, 3177300913, 874588042, 1185436845, 2064537788, 364292705, 3802247898, 3122264959, 186651829, 2789447523, 797964681, 897671294, 1504956985, 2294012382, 3916152546, 177325516, 2741945226, 4188655695, 2738134558, 557326292, 1625014790, 2945266389, 1843516240, 644046640, 3853456819, 3456105042, 3467742754, 2885173326, 812088996, 1238970324, 766072156, 2675925963, 1667463511, 2808303112, 1638756770, 260047996, 1117661655, 346883777, 2268712532, 1904918136, 513102466, 1024624509, 2154277089, 4147814745, 3681688842, 2233642964, 3135674550, 1259551210, 3286048484, 4271168802, 4227197378, 3310884772, 2063705584, 791399172, 4069266828, 1511606526, 1047713396, 615906401, 2805111822, 499223767, 740832370, 351782725, 2258776891, 1837046713, 3969757168, 2873152110, 4214869805, 3416771254, 2527945969, 3279116532, 1217038009, 4014402228, 3696705795, 1877774112, 3928347956, 959715122, 1612979629, 4045688071, 2403021083, 424891533, 1887765641, 2090726432, 2897940431, 268403838, 3447542890, 575011346, 2559143209, 532649938, 3625398853, 2077769196, 1598653066, 3104923961, 3594500739, 675029389, 579180583, 2024117612, 1351780728, 654841863, 769835263, 1431012736, 2369300321, 4157341752, 1968305076, 2086919554, 3075265115, 2128974418, 3144501489, 3993066430, 1121959765, 1373765135, 4232964375, 2264170351, 11814235, 1797654983, 3382686935, 2541491040, 3540726136, 1330685654, 4123114026, 2521290625, 3357439706, 3331159097, 2298656231, 3446738535, 290996369, 3020977553, 849241175, 3469792522, 4119898263, 1339695718, 2125209134, 3620160106, 1063375386, 1656465852, 2505508266, 3958528861, 3497875682, 3112358345, 3675237811, 1109625127, 2672368219, 1983461371, 3579663373, 1969195060, 225618775, 653511251, 3508369415, 4127429853, 828877800, 4286770015, 1474706143, 870777512, 804917422, 3913439258, 2433991646, 2742831709, 4289045475, 2899508500, 185462457, 4178107803, 2671443073, 2701796854, 1170522896, 1599880638, 1410722361, 3977867960, 1263177666, 2159508450, 2704509681, 1540819416, 1836499452, 1667451095, 3799477506, 157146600, 3717470672, 89865758, 3815588203, 1929105788, 861643665, 684514017, 3519778437, 2712956097, 1004423983, 1540346552, 2617389519, 2754800020, 870994822, 1702399767, 3526294475, 3251290865, 2365820957, 1915675760, 1828371367, 3737352795, 2511512700, 1080446781, 2565191059, 2412448535, 3719988291, 1434643780, 4163492408, 1359345746, 1457543102, 2389534435, 2800945892, 2646700564, 1719588203, 999665519, 3120652917, 1800116770, 3247314137, 4261164550, 1503462948, 3017762189, 263481701, 1754772485, 869168639, 604192231, 498759780, 2602535702, 3346756344, 2836267314, 2073734260, 3445425559, 4051271696, 1647518162, 401835417, 1968629992, 2854677838, 2381566661, 3144829468, 519547510, 3058642603, 3944140819, 1248923220, 1050321901, 3218172519, 376999645, 184187381, 3837095155, 3363256702, 751966993, 3419533016, 4028456468, 1156797460]</span><br><span class="line">[3437104340, 508103176, 1635844121, 878522509, 1923790547, 1727955782, 1371509208, 3182873539, 156878129, 1757777801, 1472806960, 3486450735, 2307527058, 2950814692, 1817110380, 372493821, 729662950, 2366747255, 774823385, 387513980, 1444397883]</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="解决方法-1"><a href="#解决方法-1" class="headerlink" title="解决方法"></a>解决方法</h2><p>看完<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/205861#h3-4">这篇</a>，以及上一题，这题也就很好解了，预测出随机数后和第二个列表里的随机数异或即可得到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> Random</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_right</span>(<span class="params">m,l,val=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">    length = <span class="number">32</span></span><br><span class="line">    mx = <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">if</span> val == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        val = mx</span><br><span class="line">    i,res = <span class="number">0</span>,<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i*l&lt;length:</span><br><span class="line">        mask = (mx&lt;&lt;(length-l)&amp;mx)&gt;&gt;i*l</span><br><span class="line">        tmp = m &amp; mask</span><br><span class="line">        m = m^tmp&gt;&gt;l&amp;val</span><br><span class="line">        res += tmp</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_left</span>(<span class="params">m,l,val</span>):</span><br><span class="line">    length = <span class="number">32</span></span><br><span class="line">    mx = <span class="number">0xffffffff</span></span><br><span class="line">    i,res = <span class="number">0</span>,<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i*l &lt; length:</span><br><span class="line">        mask = (mx&gt;&gt;(length-l)&amp;mx)&lt;&lt;i*l</span><br><span class="line">        tmp = m &amp; mask</span><br><span class="line">        m ^= tmp&lt;&lt;l&amp;val</span><br><span class="line">        res |= tmp</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_temper</span>(<span class="params">m</span>):</span><br><span class="line">    m = invert_right(m,<span class="number">18</span>)</span><br><span class="line">    m = invert_left(m,<span class="number">15</span>,<span class="number">4022730752</span>)</span><br><span class="line">    m = invert_left(m,<span class="number">7</span>,<span class="number">2636928640</span>)</span><br><span class="line">    m = invert_right(m,<span class="number">11</span>)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">clone_mt</span>(<span class="params">record</span>):</span><br><span class="line">    state = [invert_temper(i) <span class="keyword">for</span> i <span class="keyword">in</span> record]</span><br><span class="line">    gen = Random()</span><br><span class="line">    gen.setstate((<span class="number">3</span>,<span class="built_in">tuple</span>(state+[<span class="number">0</span>]),<span class="literal">None</span>))</span><br><span class="line">    <span class="keyword">return</span> gen</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">random1=[<span class="number">888058162</span>, <span class="number">3094055443</span>, <span class="number">1404990361</span>, <span class="number">1012543603</span>, <span class="number">448723884</span>, <span class="number">2580444236</span>, <span class="number">201608779</span>, <span class="number">1062995809</span>, <span class="number">1348787313</span>, <span class="number">2980019361</span>, <span class="number">2245025385</span>, <span class="number">494977308</span>, <span class="number">4042503808</span>, <span class="number">275744301</span>, <span class="number">406611131</span>, <span class="number">142226472</span>, <span class="number">3871761759</span>, <span class="number">3888795536</span>, <span class="number">2617489687</span>, <span class="number">1220227074</span>, <span class="number">342928858</span>, <span class="number">3728958896</span>, <span class="number">1477077966</span>, <span class="number">1433151407</span>, <span class="number">1119405037</span>, <span class="number">330145973</span>, <span class="number">3547181160</span>, <span class="number">2123007249</span>, <span class="number">3739964132</span>, <span class="number">1794129718</span>, <span class="number">2739743522</span>, <span class="number">2291585121</span>, <span class="number">3013727731</span>, <span class="number">1536788463</span>, <span class="number">247633572</span>, <span class="number">408079265</span>, <span class="number">3025555185</span>, <span class="number">1604681922</span>, <span class="number">2848997116</span>, <span class="number">3646041955</span>, <span class="number">1059445774</span>, <span class="number">2849764176</span>, <span class="number">2638965889</span>, <span class="number">1232303180</span>, <span class="number">759521642</span>, <span class="number">2257008531</span>, <span class="number">3932082254</span>, <span class="number">1052428413</span>, <span class="number">4017559916</span>, <span class="number">3505694223</span>, <span class="number">1418363972</span>, <span class="number">477751107</span>, <span class="number">4266295945</span>, <span class="number">3832138928</span>, <span class="number">245251422</span>, <span class="number">1964323108</span>, <span class="number">2453472918</span>, <span class="number">3029032760</span>, <span class="number">323619451</span>, <span class="number">2548825339</span>, <span class="number">3410027991</span>, <span class="number">278143595</span>, <span class="number">816124107</span>, <span class="number">245705463</span>, <span class="number">4173686519</span>, <span class="number">4100831820</span>, <span class="number">3599257115</span>, <span class="number">2274885516</span>, <span class="number">3954736394</span>, <span class="number">198254482</span>, <span class="number">1050449178</span>, <span class="number">3933150558</span>, <span class="number">899220021</span>, <span class="number">597474632</span>, <span class="number">1823539097</span>, <span class="number">3340511318</span>, <span class="number">2144918682</span>, <span class="number">2310527451</span>, <span class="number">264391694</span>, <span class="number">69923676</span>, <span class="number">3266017310</span>, <span class="number">3199627722</span>, <span class="number">4035962745</span>, <span class="number">932969905</span>, <span class="number">2832951013</span>, <span class="number">2182887504</span>, <span class="number">1374919242</span>, <span class="number">2978944795</span>, <span class="number">1840647233</span>, <span class="number">3510878043</span>, <span class="number">3250544991</span>, <span class="number">4255542321</span>, <span class="number">804377010</span>, <span class="number">1286980519</span>, <span class="number">1980427321</span>, <span class="number">2893246724</span>, <span class="number">1745353148</span>, <span class="number">1406140332</span>, <span class="number">4101848568</span>, <span class="number">3227434698</span>, <span class="number">1869729934</span>, <span class="number">2638181242</span>, <span class="number">1270111849</span>, <span class="number">2387910792</span>, <span class="number">3411542702</span>, <span class="number">2793303435</span>, <span class="number">2455337459</span>, <span class="number">2802808043</span>, <span class="number">2418872990</span>, <span class="number">1043274549</span>, <span class="number">144911746</span>, <span class="number">2312236858</span>, <span class="number">780373658</span>, <span class="number">1527499811</span>, <span class="number">3402753408</span>, <span class="number">2617924770</span>, <span class="number">1659648360</span>, <span class="number">2714315441</span>, <span class="number">4202103851</span>, <span class="number">244677433</span>, <span class="number">1963258902</span>, <span class="number">3851363324</span>, <span class="number">3454195559</span>, <span class="number">813228826</span>, <span class="number">3944899734</span>, <span class="number">3697685234</span>, <span class="number">1613584167</span>, <span class="number">1874570879</span>, <span class="number">1592343033</span>, <span class="number">4194241173</span>, <span class="number">551902434</span>, <span class="number">3460909265</span>, <span class="number">4122075287</span>, <span class="number">176665387</span>, <span class="number">152849760</span>, <span class="number">3593212904</span>, <span class="number">952880017</span>, <span class="number">1793357635</span>, <span class="number">2052902220</span>, <span class="number">807859486</span>, <span class="number">334839380</span>, <span class="number">3485132343</span>, <span class="number">2113403566</span>, <span class="number">3259106798</span>, <span class="number">1443078482</span>, <span class="number">2434820318</span>, <span class="number">1347902400</span>, <span class="number">2344061487</span>, <span class="number">141766876</span>, <span class="number">2641586235</span>, <span class="number">287277458</span>, <span class="number">2385094526</span>, <span class="number">1510128758</span>, <span class="number">348957861</span>, <span class="number">2861038633</span>, <span class="number">1135611795</span>, <span class="number">4289024199</span>, <span class="number">1021202791</span>, <span class="number">2460872523</span>, <span class="number">3837050794</span>, <span class="number">4092005952</span>, <span class="number">52622948</span>, <span class="number">387056916</span>, <span class="number">3102913460</span>, <span class="number">4098715316</span>, <span class="number">154916530</span>, <span class="number">2890197932</span>, <span class="number">1441566957</span>, <span class="number">2368779800</span>, <span class="number">271808452</span>, <span class="number">3566810840</span>, <span class="number">2227022452</span>, <span class="number">316480679</span>, <span class="number">603893066</span>, <span class="number">2121889912</span>, <span class="number">4208763743</span>, <span class="number">3098334580</span>, <span class="number">721958838</span>, <span class="number">3848020801</span>, <span class="number">1029884135</span>, <span class="number">832405094</span>, <span class="number">2276817394</span>, <span class="number">981553190</span>, <span class="number">246940442</span>, <span class="number">1069231974</span>, <span class="number">3275216531</span>, <span class="number">58945988</span>, <span class="number">4100121200</span>, <span class="number">230446475</span>, <span class="number">2396021649</span>, <span class="number">4608139</span>, <span class="number">3468707911</span>, <span class="number">3249498323</span>, <span class="number">315898153</span>, <span class="number">3280797960</span>, <span class="number">388108494</span>, <span class="number">1110548082</span>, <span class="number">2357147660</span>, <span class="number">2336724751</span>, <span class="number">4047583630</span>, <span class="number">2108667879</span>, <span class="number">2784078579</span>, <span class="number">1170844412</span>, <span class="number">3920262445</span>, <span class="number">3564073655</span>, <span class="number">590490534</span>, <span class="number">1645945278</span>, <span class="number">2487463163</span>, <span class="number">434409966</span>, <span class="number">1563546251</span>, <span class="number">888601967</span>, <span class="number">1913513318</span>, <span class="number">1327448740</span>, <span class="number">2504517969</span>, <span class="number">304688984</span>, <span class="number">1443685450</span>, <span class="number">4040619940</span>, <span class="number">3601250858</span>, <span class="number">4097529433</span>, <span class="number">4260590151</span>, <span class="number">575843085</span>, <span class="number">1114360271</span>, <span class="number">2186035374</span>, <span class="number">2821388594</span>, <span class="number">3763206347</span>, <span class="number">4283149630</span>, <span class="number">4097168778</span>, <span class="number">1924538037</span>, <span class="number">3272064650</span>, <span class="number">1689166701</span>, <span class="number">1352331676</span>, <span class="number">520525342</span>, <span class="number">2954296222</span>, <span class="number">2629516330</span>, <span class="number">3674317458</span>, <span class="number">231784130</span>, <span class="number">1930132422</span>, <span class="number">4169222397</span>, <span class="number">1638784833</span>, <span class="number">1245667959</span>, <span class="number">1253759350</span>, <span class="number">1154928813</span>, <span class="number">66021172</span>, <span class="number">3217915692</span>, <span class="number">4159785573</span>, <span class="number">3798512628</span>, <span class="number">2945489695</span>, <span class="number">700725579</span>, <span class="number">3940231312</span>, <span class="number">1960713279</span>, <span class="number">3289722468</span>, <span class="number">2970919839</span>, <span class="number">1356139680</span>, <span class="number">1141841193</span>, <span class="number">629177162</span>, <span class="number">3696263539</span>, <span class="number">1084872874</span>, <span class="number">4294077062</span>, <span class="number">1115547807</span>, <span class="number">3421092527</span>, <span class="number">611575307</span>, <span class="number">7808529</span>, <span class="number">2784523837</span>, <span class="number">1267307982</span>, <span class="number">1538837032</span>, <span class="number">4038330055</span>, <span class="number">3262951566</span>, <span class="number">3139820067</span>, <span class="number">1249725729</span>, <span class="number">757191354</span>, <span class="number">3025188720</span>, <span class="number">291705345</span>, <span class="number">575676661</span>, <span class="number">3023956263</span>, <span class="number">1045504889</span>, <span class="number">205204207</span>, <span class="number">1777650027</span>, <span class="number">1956698897</span>, <span class="number">996147619</span>, <span class="number">1470431</span>, <span class="number">2275722398</span>, <span class="number">2666078800</span>, <span class="number">470333070</span>, <span class="number">1306693906</span>, <span class="number">2968672077</span>, <span class="number">2476023772</span>, <span class="number">2645573325</span>, <span class="number">3939390068</span>, <span class="number">2874886754</span>, <span class="number">4226430090</span>, <span class="number">2290851636</span>, <span class="number">3707585663</span>, <span class="number">109770347</span>, <span class="number">127373916</span>, <span class="number">815817847</span>, <span class="number">1565834917</span>, <span class="number">636869794</span>, <span class="number">4062053412</span>, <span class="number">583594822</span>, <span class="number">3782553071</span>, <span class="number">3293311273</span>, <span class="number">2801932604</span>, <span class="number">2647080862</span>, <span class="number">1514083254</span>, <span class="number">3534640458</span>, <span class="number">342361004</span>, <span class="number">3266111849</span>, <span class="number">2157351044</span>, <span class="number">1851728420</span>, <span class="number">3412596866</span>, <span class="number">2793236910</span>, <span class="number">3758306563</span>, <span class="number">1799548561</span>, <span class="number">952631672</span>, <span class="number">912455646</span>, <span class="number">2894404493</span>, <span class="number">2194084105</span>, <span class="number">119615608</span>, <span class="number">2071058651</span>, <span class="number">1524462411</span>, <span class="number">900936180</span>, <span class="number">3697554830</span>, <span class="number">3501838982</span>, <span class="number">2874465656</span>, <span class="number">2501478689</span>, <span class="number">1069024222</span>, <span class="number">3135689372</span>, <span class="number">1168458702</span>, <span class="number">1966524629</span>, <span class="number">36400028</span>, <span class="number">2704775319</span>, <span class="number">4030739700</span>, <span class="number">3985599923</span>, <span class="number">2778920518</span>, <span class="number">2669538325</span>, <span class="number">1951594393</span>, <span class="number">795749079</span>, <span class="number">665593501</span>, <span class="number">3007338649</span>, <span class="number">1535343068</span>, <span class="number">2031873237</span>, <span class="number">3202423789</span>, <span class="number">560224943</span>, <span class="number">1290838890</span>, <span class="number">2545130826</span>, <span class="number">695695377</span>, <span class="number">3048615291</span>, <span class="number">1957903923</span>, <span class="number">1986693779</span>, <span class="number">2594986519</span>, <span class="number">3396211122</span>, <span class="number">2625687092</span>, <span class="number">575329062</span>, <span class="number">2852671310</span>, <span class="number">3472799759</span>, <span class="number">715985207</span>, <span class="number">1660331651</span>, <span class="number">958648594</span>, <span class="number">305711662</span>, <span class="number">75621441</span>, <span class="number">548447557</span>, <span class="number">2473842353</span>, <span class="number">2110558182</span>, <span class="number">3321750402</span>, <span class="number">2415793078</span>, <span class="number">815198061</span>, <span class="number">1258834500</span>, <span class="number">972966677</span>, <span class="number">3267046345</span>, <span class="number">2923564883</span>, <span class="number">518207679</span>, <span class="number">1662309775</span>, <span class="number">278933232</span>, <span class="number">4294256390</span>, <span class="number">2444117793</span>, <span class="number">2241879973</span>, <span class="number">3915962245</span>, <span class="number">3836532482</span>, <span class="number">3449260219</span>, <span class="number">1092128833</span>, <span class="number">3177300913</span>, <span class="number">874588042</span>, <span class="number">1185436845</span>, <span class="number">2064537788</span>, <span class="number">364292705</span>, <span class="number">3802247898</span>, <span class="number">3122264959</span>, <span class="number">186651829</span>, <span class="number">2789447523</span>, <span class="number">797964681</span>, <span class="number">897671294</span>, <span class="number">1504956985</span>, <span class="number">2294012382</span>, <span class="number">3916152546</span>, <span class="number">177325516</span>, <span class="number">2741945226</span>, <span class="number">4188655695</span>, <span class="number">2738134558</span>, <span class="number">557326292</span>, <span class="number">1625014790</span>, <span class="number">2945266389</span>, <span class="number">1843516240</span>, <span class="number">644046640</span>, <span class="number">3853456819</span>, <span class="number">3456105042</span>, <span class="number">3467742754</span>, <span class="number">2885173326</span>, <span class="number">812088996</span>, <span class="number">1238970324</span>, <span class="number">766072156</span>, <span class="number">2675925963</span>, <span class="number">1667463511</span>, <span class="number">2808303112</span>, <span class="number">1638756770</span>, <span class="number">260047996</span>, <span class="number">1117661655</span>, <span class="number">346883777</span>, <span class="number">2268712532</span>, <span class="number">1904918136</span>, <span class="number">513102466</span>, <span class="number">1024624509</span>, <span class="number">2154277089</span>, <span class="number">4147814745</span>, <span class="number">3681688842</span>, <span class="number">2233642964</span>, <span class="number">3135674550</span>, <span class="number">1259551210</span>, <span class="number">3286048484</span>, <span class="number">4271168802</span>, <span class="number">4227197378</span>, <span class="number">3310884772</span>, <span class="number">2063705584</span>, <span class="number">791399172</span>, <span class="number">4069266828</span>, <span class="number">1511606526</span>, <span class="number">1047713396</span>, <span class="number">615906401</span>, <span class="number">2805111822</span>, <span class="number">499223767</span>, <span class="number">740832370</span>, <span class="number">351782725</span>, <span class="number">2258776891</span>, <span class="number">1837046713</span>, <span class="number">3969757168</span>, <span class="number">2873152110</span>, <span class="number">4214869805</span>, <span class="number">3416771254</span>, <span class="number">2527945969</span>, <span class="number">3279116532</span>, <span class="number">1217038009</span>, <span class="number">4014402228</span>, <span class="number">3696705795</span>, <span class="number">1877774112</span>, <span class="number">3928347956</span>, <span class="number">959715122</span>, <span class="number">1612979629</span>, <span class="number">4045688071</span>, <span class="number">2403021083</span>, <span class="number">424891533</span>, <span class="number">1887765641</span>, <span class="number">2090726432</span>, <span class="number">2897940431</span>, <span class="number">268403838</span>, <span class="number">3447542890</span>, <span class="number">575011346</span>, <span class="number">2559143209</span>, <span class="number">532649938</span>, <span class="number">3625398853</span>, <span class="number">2077769196</span>, <span class="number">1598653066</span>, <span class="number">3104923961</span>, <span class="number">3594500739</span>, <span class="number">675029389</span>, <span class="number">579180583</span>, <span class="number">2024117612</span>, <span class="number">1351780728</span>, <span class="number">654841863</span>, <span class="number">769835263</span>, <span class="number">1431012736</span>, <span class="number">2369300321</span>, <span class="number">4157341752</span>, <span class="number">1968305076</span>, <span class="number">2086919554</span>, <span class="number">3075265115</span>, <span class="number">2128974418</span>, <span class="number">3144501489</span>, <span class="number">3993066430</span>, <span class="number">1121959765</span>, <span class="number">1373765135</span>, <span class="number">4232964375</span>, <span class="number">2264170351</span>, <span class="number">11814235</span>, <span class="number">1797654983</span>, <span class="number">3382686935</span>, <span class="number">2541491040</span>, <span class="number">3540726136</span>, <span class="number">1330685654</span>, <span class="number">4123114026</span>, <span class="number">2521290625</span>, <span class="number">3357439706</span>, <span class="number">3331159097</span>, <span class="number">2298656231</span>, <span class="number">3446738535</span>, <span class="number">290996369</span>, <span class="number">3020977553</span>, <span class="number">849241175</span>, <span class="number">3469792522</span>, <span class="number">4119898263</span>, <span class="number">1339695718</span>, <span class="number">2125209134</span>, <span class="number">3620160106</span>, <span class="number">1063375386</span>, <span class="number">1656465852</span>, <span class="number">2505508266</span>, <span class="number">3958528861</span>, <span class="number">3497875682</span>, <span class="number">3112358345</span>, <span class="number">3675237811</span>, <span class="number">1109625127</span>, <span class="number">2672368219</span>, <span class="number">1983461371</span>, <span class="number">3579663373</span>, <span class="number">1969195060</span>, <span class="number">225618775</span>, <span class="number">653511251</span>, <span class="number">3508369415</span>, <span class="number">4127429853</span>, <span class="number">828877800</span>, <span class="number">4286770015</span>, <span class="number">1474706143</span>, <span class="number">870777512</span>, <span class="number">804917422</span>, <span class="number">3913439258</span>, <span class="number">2433991646</span>, <span class="number">2742831709</span>, <span class="number">4289045475</span>, <span class="number">2899508500</span>, <span class="number">185462457</span>, <span class="number">4178107803</span>, <span class="number">2671443073</span>, <span class="number">2701796854</span>, <span class="number">1170522896</span>, <span class="number">1599880638</span>, <span class="number">1410722361</span>, <span class="number">3977867960</span>, <span class="number">1263177666</span>, <span class="number">2159508450</span>, <span class="number">2704509681</span>, <span class="number">1540819416</span>, <span class="number">1836499452</span>, <span class="number">1667451095</span>, <span class="number">3799477506</span>, <span class="number">157146600</span>, <span class="number">3717470672</span>, <span class="number">89865758</span>, <span class="number">3815588203</span>, <span class="number">1929105788</span>, <span class="number">861643665</span>, <span class="number">684514017</span>, <span class="number">3519778437</span>, <span class="number">2712956097</span>, <span class="number">1004423983</span>, <span class="number">1540346552</span>, <span class="number">2617389519</span>, <span class="number">2754800020</span>, <span class="number">870994822</span>, <span class="number">1702399767</span>, <span class="number">3526294475</span>, <span class="number">3251290865</span>, <span class="number">2365820957</span>, <span class="number">1915675760</span>, <span class="number">1828371367</span>, <span class="number">3737352795</span>, <span class="number">2511512700</span>, <span class="number">1080446781</span>, <span class="number">2565191059</span>, <span class="number">2412448535</span>, <span class="number">3719988291</span>, <span class="number">1434643780</span>, <span class="number">4163492408</span>, <span class="number">1359345746</span>, <span class="number">1457543102</span>, <span class="number">2389534435</span>, <span class="number">2800945892</span>, <span class="number">2646700564</span>, <span class="number">1719588203</span>, <span class="number">999665519</span>, <span class="number">3120652917</span>, <span class="number">1800116770</span>, <span class="number">3247314137</span>, <span class="number">4261164550</span>, <span class="number">1503462948</span>, <span class="number">3017762189</span>, <span class="number">263481701</span>, <span class="number">1754772485</span>, <span class="number">869168639</span>, <span class="number">604192231</span>, <span class="number">498759780</span>, <span class="number">2602535702</span>, <span class="number">3346756344</span>, <span class="number">2836267314</span>, <span class="number">2073734260</span>, <span class="number">3445425559</span>, <span class="number">4051271696</span>, <span class="number">1647518162</span>, <span class="number">401835417</span>, <span class="number">1968629992</span>, <span class="number">2854677838</span>, <span class="number">2381566661</span>, <span class="number">3144829468</span>, <span class="number">519547510</span>, <span class="number">3058642603</span>, <span class="number">3944140819</span>, <span class="number">1248923220</span>, <span class="number">1050321901</span>, <span class="number">3218172519</span>, <span class="number">376999645</span>, <span class="number">184187381</span>, <span class="number">3837095155</span>, <span class="number">3363256702</span>, <span class="number">751966993</span>, <span class="number">3419533016</span>, <span class="number">4028456468</span>, <span class="number">1156797460</span>]</span><br><span class="line">random2=[<span class="number">3437104340</span>, <span class="number">508103176</span>, <span class="number">1635844121</span>, <span class="number">878522509</span>, <span class="number">1923790547</span>, <span class="number">1727955782</span>, <span class="number">1371509208</span>, <span class="number">3182873539</span>, <span class="number">156878129</span>, <span class="number">1757777801</span>, <span class="number">1472806960</span>, <span class="number">3486450735</span>, <span class="number">2307527058</span>, <span class="number">2950814692</span>, <span class="number">1817110380</span>, <span class="number">372493821</span>, <span class="number">729662950</span>, <span class="number">2366747255</span>, <span class="number">774823385</span>, <span class="number">387513980</span>, <span class="number">1444397883</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(random1))</span><br><span class="line">g = clone_mt(random1[:<span class="number">624</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">    g.getrandbits(<span class="number">32</span>)</span><br><span class="line">flag=<span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> random2:</span><br><span class="line">    mt = g.getrandbits(<span class="number">32</span>)</span><br><span class="line">    part = <span class="built_in">int</span>(mt^i)</span><br><span class="line">    m=long_to_bytes(part)</span><br><span class="line">    flag+=m</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>当要%两个数时，比如%q   %n， 先%q，%n可以等会写，也可以直接k*q，再%n</p>
<p>当计算的式子有幂（比如平方，立法）时，需要%他后面的数字，无论在哪边</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://kbthe0phi1us.github.io">KBThe0phi1us</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://kbthe0phi1us.github.io/2023/02/10/MT19937%E7%AE%97%E6%B3%95/">https://kbthe0phi1us.github.io/2023/02/10/MT19937算法/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://kbthe0phi1us.github.io" target="_blank">KBThe0phi1us's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ctf/">ctf</a><a class="post-meta__tags" href="/tags/crypto/">crypto</a><a class="post-meta__tags" href="/tags/%E9%A2%98%E9%9B%86/">题集</a></div><div class="post_share"><div class="social-share" data-image="https://s1.vika.cn/space/2023/02/04/f08b3172ebdd46f9aec2dce48cabf062" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/02/07/NSSRound%207%20Team%20crypto%E7%AF%87%E9%83%A8%E5%88%86wp/" title="NSSRound 7 Team crypto篇部分wp"><img class="cover" src="https://s1.vika.cn/space/2023/02/04/626e14e54190481f90b0245b88518446" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">NSSRound 7 Team crypto篇部分wp</div></div></a></div><div class="next-post pull-right"><a href="/2023/02/10/NSS%20Crtpto%E9%A2%98%E9%9B%86%E4%B8%80/" title="NSS Crtpto题集一"><img class="cover" src="https://s1.vika.cn/space/2023/02/04/24fdd38c5e9b4c1fb4927fca0b4c29ad" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">NSS Crtpto题集一</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/02/10/NSS%20Crtpto%E9%A2%98%E9%9B%86%E4%B8%80/" title="NSS Crtpto题集一"><img class="cover" src="https://s1.vika.cn/space/2023/02/04/24fdd38c5e9b4c1fb4927fca0b4c29ad" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-10</div><div class="title">NSS Crtpto题集一</div></div></a></div><div><a href="/2023/02/10/NSS%20Crypto%E9%A2%98%E9%9B%86%E4%BA%8C/" title="NSS Crtpto题集二"><img class="cover" src="https://s1.vika.cn/space/2023/02/04/cc052600496848718f0d3eca04e86734" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-10</div><div class="title">NSS Crtpto题集二</div></div></a></div><div><a href="/2023/02/16/SMUPE%20%E9%97%AE%E9%A2%98/" title="线性和非线性填充下的广播攻击"><img class="cover" src="https://s1.vika.cn/space/2023/02/04/8b612b9f64644781a22ebdbbc2eded6d" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-16</div><div class="title">线性和非线性填充下的广播攻击</div></div></a></div><div><a href="/2023/01/11/2023%20hgame%20week1%20Crypto%E7%AF%87wp/" title="2023 hgame week1 Crypto篇wp"><img class="cover" src="https://s1.vika.cn/space/2023/02/04/8dbc7b4bc548452bbe59ded88ce862d0" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-01-11</div><div class="title">2023 hgame week1 Crypto篇wp</div></div></a></div><div><a href="/2023/01/21/2023%20hgame%20week2%20Crypto%E7%AF%87wp/" title="2023 hgame week2 Crypto篇部分wp"><img class="cover" src="https://s1.vika.cn/space/2023/02/04/131942ac19f942e48764f15336f9f511" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-01-21</div><div class="title">2023 hgame week2 Crypto篇部分wp</div></div></a></div><div><a href="/2023/02/04/2023%20%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91%20crypto%E7%AF%87wp/" title="2023 西湖论剑 crypto篇部分wp"><img class="cover" src="https://s1.vika.cn/space/2023/02/04/233780dd53f84123b1b03429b9f279a6" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-04</div><div class="title">2023 西湖论剑 crypto篇部分wp</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s1.vika.cn/space/2023/02/05/8bc2037846ab481088ddf95238ee1b14" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">KBThe0phi1us</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/KBThe0phi1us"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/KBThe0phi1us" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:k2869374743@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GKCTF-2021-Random"><span class="toc-number">2.</span> <span class="toc-text">[GKCTF 2021]Random</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE"><span class="toc-number">2.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E4%B8%80"><span class="toc-number">2.2.</span> <span class="toc-text">解决方法一</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="toc-number">2.3.</span> <span class="toc-text">解决方法二</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HNCTF-2022-WEEK4-random"><span class="toc-number">3.</span> <span class="toc-text">[HNCTF 2022 WEEK4]random</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-1"><span class="toc-number">3.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95"><span class="toc-number">3.2.</span> <span class="toc-text">解决方法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HGAME-2022-week4-PRNG"><span class="toc-number">4.</span> <span class="toc-text">[HGAME 2022 week4]PRNG</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-2"><span class="toc-number">4.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95-1"><span class="toc-number">4.2.</span> <span class="toc-text">解决方法</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/02/16/SMUPE%20%E9%97%AE%E9%A2%98/" title="线性和非线性填充下的广播攻击"><img src="https://s1.vika.cn/space/2023/02/04/8b612b9f64644781a22ebdbbc2eded6d" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="线性和非线性填充下的广播攻击"/></a><div class="content"><a class="title" href="/2023/02/16/SMUPE%20%E9%97%AE%E9%A2%98/" title="线性和非线性填充下的广播攻击">线性和非线性填充下的广播攻击</a><time datetime="2023-02-16T14:01:18.000Z" title="发表于 2023-02-16 22:01:18">2023-02-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/14/%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81/" title="仿射密码"><img src="https://s1.vika.cn/space/2023/02/04/f08b3172ebdd46f9aec2dce48cabf062" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="仿射密码"/></a><div class="content"><a class="title" href="/2023/02/14/%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81/" title="仿射密码">仿射密码</a><time datetime="2023-02-14T06:42:12.000Z" title="发表于 2023-02-14 14:42:12">2023-02-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/13/HSCSEC%20CTF%202023%E9%83%A8%E5%88%86WP/" title="HSCSEC CTF 2023部分wp"><img src="https://s1.vika.cn/space/2023/02/04/95bb541cf54c4545aee7bb5d0894449a" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HSCSEC CTF 2023部分wp"/></a><div class="content"><a class="title" href="/2023/02/13/HSCSEC%20CTF%202023%E9%83%A8%E5%88%86WP/" title="HSCSEC CTF 2023部分wp">HSCSEC CTF 2023部分wp</a><time datetime="2023-02-13T04:42:12.000Z" title="发表于 2023-02-13 12:42:12">2023-02-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/10/NSS%20Crypto%E9%A2%98%E9%9B%86%E4%BA%8C/" title="NSS Crtpto题集二"><img src="https://s1.vika.cn/space/2023/02/04/cc052600496848718f0d3eca04e86734" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="NSS Crtpto题集二"/></a><div class="content"><a class="title" href="/2023/02/10/NSS%20Crypto%E9%A2%98%E9%9B%86%E4%BA%8C/" title="NSS Crtpto题集二">NSS Crtpto题集二</a><time datetime="2023-02-10T14:01:18.000Z" title="发表于 2023-02-10 22:01:18">2023-02-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/10/NSS%20Crtpto%E9%A2%98%E9%9B%86%E4%B8%80/" title="NSS Crtpto题集一"><img src="https://s1.vika.cn/space/2023/02/04/24fdd38c5e9b4c1fb4927fca0b4c29ad" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="NSS Crtpto题集一"/></a><div class="content"><a class="title" href="/2023/02/10/NSS%20Crtpto%E9%A2%98%E9%9B%86%E4%B8%80/" title="NSS Crtpto题集一">NSS Crtpto题集一</a><time datetime="2023-02-10T09:42:12.000Z" title="发表于 2023-02-10 17:42:12">2023-02-10</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 By KBThe0phi1us</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://kbthe0phi1us.github.io/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><a class="icon-V hidden" onclick="switchNightMode()" title="浅色和深色模式转换"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container').forEach(node => {
            if (node.hasAttribute('display')) {
              btf.wrap(node, 'div', { class: 'mathjax-overflow' })
            } else {
              btf.wrap(node, 'span', { class: 'mathjax-overflow' })
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script></div><script defer type="text/javascript" src="https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js"></script><script defer src="/js/lunar.js"></script><script defer src="/js/day.js"></script><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script src="/js/sun_moon.js" async></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":100,"height":200},"mobile":{"show":true},"log":false});</script></body></html>